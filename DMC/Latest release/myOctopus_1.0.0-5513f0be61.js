angular.module("myOctopusDMC",["ui.router"]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$injector",function(o,t,n,r){o.state("dashboard",{templateUrl:"app/dashboard/dashboard.html",authorize:!1}).state("sensors",{templateUrl:"app/sensors/sensors.html",authorize:!1}).state("configuration",{templateUrl:"app/configuration/configuration.html",authorize:!1})}]).controller("shellController",["$scope","$state",function(o,t){o.commands={},o.commands.showDashboard=function(){t.go("dashboard")},o.commands.showSensors=function(){t.go("sensors")},o.commands.showConfiguration=function(){t.go("configuration")},o.commands.showConfiguration_wifi=function(){t.go("configuration_wifi")},o.commands.showConfiguration_bluetooth=function(){t.go("configuration_bluetooth")},t.go("dashboard")}]).factory("notificationsService",["$http",function(o){var t={};return t.failed=function(o,t){toastr.options.timeOut=2e3,toastr.warning(t,o)},t.success=function(o,t){toastr.success(t,o)},t}]).factory("errorsService",["$http",function(o){var t={};return t}]).factory("interactionsService",["$http",function(o){var t={};return t}]).factory("logService",["$http",function(o){var t={};return t}]);
angular.module("myOctopusDMC").controller("configurationController",["$scope","$q","octopusDeviceService",function(o,e,n){o.menu={wifi:"wifi",bluetooth:"bluetooth",console:"console"},o.activeMenu=o.menu.wifi,o.commands.openWifi=function(){o.activeMenu=o.menu.wifi},o.commands.openBluetooth=function(){o.activeMenu=o.menu.bluetooth},o.commands.openConsole=function(){o.activeMenu=o.menu.console}}]);
angular.module("myOctopusDMC").controller("dashboardController",["$scope","$q","octopusDeviceService",function(o,r,e){o.commands.refreshDashboard=function(){o.$broadcast("EVENT_dashboardRefresh")}}]);
angular.module("myOctopusDMC").factory("octopusDeviceService",["$q",function(e){var t={};return t.getCpuStats=function(){return e(function(e,t){var a={};a.cpuUsagePercent=Math.floor(100*Math.random()+1),e(a)})},t.getMemoryStats=function(){return e(function(e,t){var a={};a.totalMemory=4e5,a.freeMemoryPercentage=Math.floor(100*Math.random()+1),e(a)})},t.getStorageStats=function(){return e(function(e,t){var a={};a.totalStorageSizeInMB=4e3,a.freeStorageSizeInMB=Math.floor(4e3*Math.random()+1),a.freeStorageSizeInPercentage=Math.floor(100*Math.random()+1),e(a)})},t.getWifiStats=function(){return e(function(e,t){var a={};a.isEnabled=!0,a.isConnected=!0,a.networkSSID="Home network",e(a)})},t.getBluetoothStats=function(){return e(function(e,t){var a={};a.isEnabled=!0,e(a)})},t.getSensorsStats=function(){return e(function(e,t){var a=new Date,n={};n.sensors=[],n.sensors.push({sensor:Octopus.sensors.temperature,lastReadingDate:a,lastReadingValue:Math.floor(1e3*Math.random()+1)}),n.sensors.push({sensor:Octopus.sensors.humidity,lastReadingDate:a,lastReadingValue:Math.floor(1e3*Math.random()+1)}),n.sensors.push({sensor:Octopus.sensors.light,lastReadingDate:a,lastReadingValue:Math.floor(1e3*Math.random()+1)}),n.sensors.push({sensor:Octopus.sensors.pressure,lastReadingDate:a,lastReadingValue:Math.floor(1e3*Math.random()+1)}),e(n)})},t.getSensorsHistoricValues=function(t){return e(function(e,a){setTimeout(function(){var a=Math.floor(50*Math.random()+1),n=function(e,t){return e=e?e.getTime():new Date(1900,0,1).getTime(),t=t?t.getTime():new Date(2100,0,1).getTime(),new Date(e+Math.random()*(t-e))},r={};for(r.data=[],i=0;i<a;i++){var o=[];o.push(n(t.from,t.to)),o.push(Math.floor(100*Math.random()+1)),r.data.push(o)}e(r)},1e3)})},t}]);var Octopus=Octopus||{};Octopus.sensors={temperature:{id:1,name:"Temperature"},humidity:{id:2,name:"Humidity"},light:{id:3,name:"Light"},pressure:{id:4,name:"Pressure"}};
angular.module("myOctopusDMC").controller("sensorsController",["$scope","$q","octopusDeviceService",function(e,t,r){e.isChart=!0,e.activeSensor=Octopus.sensors.temperature,e.sensorData={},e.commands.showSensor_temperature=function(){e.activeSensor=Octopus.sensors.temperature,e.refreshData()},e.commands.showSensor_humidity=function(){e.activeSensor=Octopus.sensors.humidity,e.refreshData()},e.commands.showSensor_light=function(){e.activeSensor=Octopus.sensors.light,e.refreshData()},e.commands.showSensor_pressure=function(){e.activeSensor=Octopus.sensors.pressure,e.refreshData()},e.commands.sensors_showTable=function(){e.isChart=!1},e.commands.sensors_showChart=function(){e.isChart=!0},e.commands.sensors_refreshData=function(){var t={};t.sensor=e.activeSensor,t.from=e.filter_from,t.to=e.filter_to,e.lockForLoading(),r.getSensorsHistoricValues(t).then(function(t){e.sensorData=t.data,e.unlockForLoading()},function(t){e.unlockForLoading()})},e.lockForLoading=function(){NProgress.configure({parent:"#s_middle"}),NProgress.start()},e.unlockForLoading=function(){NProgress.done()},e.refreshData=function(){e.commands.sensors_refreshData()},e.getCurrentDate=function(){return new Date},e.getCurrentDate_midnightOne=function(){var e=new Date;return e.setHours(0,0,0,0),e},e.filter_from=e.getCurrentDate_midnightOne(),e.filter_to=e.getCurrentDate()}]).directive("schart",["$q","octopusDeviceService",function(e,t){return function(e,t,r){t.highcharts({chart:{type:"line"},title:{text:"Monthly Average Temperature"},subtitle:{text:"Source: WorldClimate.com"},xAxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},yAxis:{title:{text:"Temperature (ï¿½C)"}},plotOptions:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1}},series:[{name:"Serie",data:e.sensorData}]})}}]).directive("stable",["$q","octopusDeviceService",function(e,t){return function(e,t,r){var o=$("<table><thead><tr><th>Date</th><th>Value</th></tr></thead></table>");t.append(o),o.dataTable({data:e.sensorData})}}]);
angular.module("myOctopusDMC").directive("bluetooth",function(){return{replace:"true",templateUrl:"app/configuration/bluetooth/bluetooth.html",controller:["$scope",function(o){o.isBluetoothEnabled=!1,o.commands.enableBluetooth=function(){},o.commands.disableBluetooth=function(){}}]}});
angular.module("myOctopusDMC").directive("console",function(){return{replace:"true",templateUrl:"app/configuration/console/console.html"}});
angular.module("myOctopusDMC").directive("wifi",function(){return{replace:"true",templateUrl:"app/configuration/wifi/wifi.html",controller:["$scope",function(e){e.isWifiEnabled=!1,e.isWifiConnected=!1,e.connectedNetwork="",e.availableNetworks=[],e.commands.disconnectNetwork=function(){},e.commands.enableWifi=function(){},e.commands.disableWifi=function(){},e.commands.refreshAvailableNetworks=function(){e.availableNetworks=["Network A","Network B","Network C"]},e.commands.connectToNetwork=function(e){}}]}});
var Widgets=Widgets||{};Widgets.create=function(e){var t={};return t.onRefreshing=null,t.onRedrawing=null,t.draw=function(){t.onRedrawing()},t.autoRefresh=function(){setTimeout(function(){t.refreshWidget(),t.autoRefresh()},1e3)},t.refreshWidget=function(){t.onRefreshing()},e.$on("EVENT_dashboardRefresh",function(t,n){e.refreshWidget()}),t.error=function(e){},t},Widgets.drawPercentageGauge=function(e,t,n,i){var r=30,a=t/2,s=n/2+50,d=n/2+30,o="#506eb9",g="white",c="white",u=i/100,l=180*u,f=i+"%";e.clear();e.circularArc(a,s,d,360-(180-l),360).attr({stroke:c,"stroke-width":r}),e.circularArc(a,s,d,180,180+l).attr({stroke:o,"stroke-width":r});e.text(a,s-20,f).attr({"font-size":"26px",fill:g})},angular.module("myOctopusDMC").directive("cpuWidget",["$q","octopusDeviceService",function(e,t){return{scope:!0,templateUrl:"app/dashboard/widgets/w_gauge.html",link:function(e,n,i){e.title="CPU",e.details="Intel Edison Cores",e.stats=null,e.widget=Widgets.create(e);var r=Raphael(n[0].querySelector(".gWidget_c"),"100%","100%");e.widget.onRedrawing=function(){null!=e.stats&&Widgets.drawPercentageGauge(r,280,130,e.stats.cpuUsagePercent)},e.widget.onRefreshing=function(){t.getCpuStats().then(function(t){e.stats=t,e.widget.draw()},function(e){widget.error(e)})},e.widget.refreshWidget(),e.widget.autoRefresh()}}}]).directive("memoryWidget",["$q","octopusDeviceService",function(e,t){return{scope:!0,templateUrl:"app/dashboard/widgets/w_gauge.html",link:function(e,n,i){e.stats=null,e.title="MEMORY",e.details="Intel Edison Memory",e.widget=Widgets.create(e);var r=Raphael(n[0].querySelector(".gWidget_c"),"100%","100%");e.widget.onRedrawing=function(){null!=e.stats&&Widgets.drawPercentageGauge(r,280,130,e.stats.freeMemoryPercentage)},e.widget.onRefreshing=function(){t.getMemoryStats().then(function(t){e.stats=t,e.widget.draw()},function(e){widget.error(e)})},e.widget.refreshWidget()}}}]).directive("storageWidget",["$q","octopusDeviceService",function(e,t){return{scope:!0,templateUrl:"app/dashboard/widgets/w_gauge.html",link:function(e,n,i){e.stats=null,e.title="STORAGE",e.details="Intel Edison Storage",e.widget=Widgets.create(e);var r=Raphael(n[0].querySelector(".gWidget_c"),"100%","100%");e.widget.onRedrawing=function(){null!=e.stats&&Widgets.drawPercentageGauge(r,280,130,e.stats.freeStorageSizeInPercentage)},e.widget.onRefreshing=function(){t.getStorageStats().then(function(t){e.stats=t,e.widget.draw()},function(e){widget.error(e)})},e.widget.refreshWidget()}}}]).directive("wifiWidget",["$q","octopusDeviceService",function(e,t){return{scope:!0,link:function(e,n,i){e.stats=null,e.widget=Widgets.create(e),e.widget.onRedrawing=function(){n.empty(),null!=e.stats&&(n.append("<p>isEnabled: "+e.stats.isEnabled+"</p>"),n.append("<p>isConnected: "+e.stats.isConnected+"</p>"),n.append("<p>networkSSID: "+e.stats.networkSSID+"</p>"))},e.widget.onRefreshing=function(){t.getWifiStats().then(function(t){e.stats=t,e.widget.draw()},function(e){widget.error(e)})},e.widget.refreshWidget(),e.widget.autoRefresh()}}}]).directive("bluetoothWidget",["$q","octopusDeviceService",function(e,t){return{scope:!0,link:function(e,n,i){e.stats=null,e.widget=Widgets.create(e),e.widget.onRedrawing=function(){n.empty(),null!=e.stats&&n.append("<p>isEnabled: "+e.stats.isEnabled+"</p>")},e.widget.onRefreshing=function(){t.getBluetoothStats().then(function(t){e.stats=t,e.widget.draw()},function(e){widget.error(e)})},e.widget.refreshWidget(),e.widget.autoRefresh()}}}]).directive("sensorsWidget",["$q","octopusDeviceService",function(e,t){return{scope:!0,templateUrl:"app/dashboard/widgets/w_sensors.html",link:function(e,n,i){e.stats=null,e.widget=Widgets.create(e),e.widget.onRedrawing=function(){if(null!=e.stats){var t=$("#sensorsBody");t.empty(),$.each(e.stats.sensors,function(e,n){t.append("<tr>"),t.append("<td style='text-align: left;'>"+n.sensor.name+"</td>"),t.append("<td>"+n.lastReadingDate.toLocaleDateString()+"  </td>"),t.append("<td>"+n.lastReadingValue+"</td>"),t.append("</tr>")}),t.append("</table>")}},e.widget.onRefreshing=function(){t.getSensorsStats().then(function(t){e.stats=t,e.widget.draw()},function(e){widget.error(e)})},e.widget.refreshWidget(),e.widget.autoRefresh()}}}]),Raphael.fn.arc=function(e,t,n,i,r,a,s){var d=[r,a,s,0,1,n,i].join(" ");return this.path("M"+e+" "+t+" a "+d)},Raphael.fn.circularArc=function(e,t,n,i,r){var a=e+n*Math.cos(i*Math.PI/180),s=t+n*Math.sin(i*Math.PI/180),d=e+n*Math.cos(r*Math.PI/180),o=t+n*Math.sin(r*Math.PI/180);return this.arc(a,s,d-a,o-s,n,n,0)};
angular.module("myOctopusDMC").run(["$templateCache", function($templateCache) {$templateCache.put("app/configuration/configuration.html","<div ng-controller=configurationController><div class=c_leftPanel><div class=c_menu_item ng-click=commands.openWifi()>Wifi</div><div class=c_menu_item ng-click=commands.openBluetooth()>Bluetooth</div><div class=c_menu_item ng-click=commands.openConsole()>Console</div></div><div class=c_content><div ng-if=\"activeMenu==\'wifi\'\" data-wifi>wifi</div><div ng-if=\"activeMenu==\'bluetooth\'\" data-bluetooth>bluetooth</div><div ng-if=\"activeMenu==\'console\'\" data-console>console</div></div></div>");
$templateCache.put("app/dashboard/dashboard.html","<div id=dashboard ng-controller=dashboardController><div class=dashboard_row><div class=gWidget_container cpu-widget></div><div class=gWidget_container memory-widget></div><div class=gWidget_container storage-widget></div></div><div class=dashboard_row><div class=widget wifi-widget></div><div class=widget bluetooth-widget></div></div><div class=dashboard_row><div class=widget sensors-widget></div></div></div>");
$templateCache.put("app/sensors/sensors.html","<div ng-controller=sensorsController><div class=s_panels><div class=\"s_panel s_panel_left\"><div class=s_menu><div class=s_menu_item ng-click=commands.showSensor_temperature() ng-class=\"{s_menu_selected: activeSensor.id == 1}\">Temperature</div><div class=s_menu_item ng-click=commands.showSensor_humidity() ng-class=\"{s_menu_selected: activeSensor.id == 2}\">Humidity</div><div class=s_menu_item ng-click=commands.showSensor_light() ng-class=\"{s_menu_selected: activeSensor.id == 3}\">Light</div><div class=s_menu_item ng-click=commands.showSensor_pressure() ng-class=\"{s_menu_selected: activeSensor.id == 4}\">Pressure</div></div></div><div class=\"s_panel s_panel_middle\"><div id=s_middle class=s_middle><div class=s_header><p>{{activeSensor.name}}</p><button ng-click=commands.sensors_showChart()>Chart</button> <button ng-click=commands.sensors_showTable()>Table</button> <button ng-click=commands.sensors_refreshData()>Refresh</button></div><div class=s_chartOrTablePanel><div ng-if=\"isChart==true\" data-schart></div><div ng-if=\"isChart==false\" data-stable></div></div></div></div><div class=\"s_panel s_panel_right\"><div>From</div><input type=date ng-model=filter_from> <input type=time ng-model=filter_from><div>To</div><input type=date ng-model=filter_to> <input type=time ng-model=filter_to></div></div></div>");
$templateCache.put("app/configuration/bluetooth/bluetooth.html","<div><button ng-click=commands.enableBluetooth()>Enable bluetooth</button> <button ng-click=commands.disableBluetooth()>Disable bluetooth</button><p>Is enabled: {{isBluetoothEnabled}}</p></div>");
$templateCache.put("app/configuration/console/console.html","<div>I\'m your template console</div>");
$templateCache.put("app/configuration/wifi/wifi.html","<div><button ng-click=commands.enableWifi()>Enable wifi</button> <button ng-click=commands.disableWifi()>Disable wifi</button><p>Is enabled: {{isWifiEnabled}}</p><p>Is connected: {{isWifiConnected}}</p><p>Connected to network: {{connectedNetwork}}</p><button ng-click=commands.refreshAvailableNetworks()>Refresh networks</button><ul><li ng-repeat=\"n in availableNetworks\">{{n}} <button ng-click=commands.connectToNetwork(n)>Connect</button></li></ul></div>");
$templateCache.put("app/dashboard/widgets/w_gauge.html","<div class=gWidget><div class=gWidget_h><div class=gWidget_centeredCell>{{title}}</div></div><div class=gWidget_c></div><div class=gWidget_b><div class=gWidget_centeredCell><p>{{details}}</p></div></div></div>");
$templateCache.put("app/dashboard/widgets/w_sensors.html","<table><thead><tr class=wsens_head><th>Name</th><th>Date</th><th>Value</th></tr></thead><tbody id=sensorsBody></tbody></table>");}]);